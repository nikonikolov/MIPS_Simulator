<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>My Project: Testing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Testing</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga312db36c134785e2b382a551bd2b420c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mips__test.html#ga312db36c134785e2b382a551bd2b420c">mips_test_begin_suite</a> ()</td></tr>
<tr class="separator:ga312db36c134785e2b382a551bd2b420c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b2f60bc6a25235b5aad5a89f5562370"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mips__test.html#ga7b2f60bc6a25235b5aad5a89f5562370">mips_test_begin_test</a> (const char *instruction)</td></tr>
<tr class="separator:ga7b2f60bc6a25235b5aad5a89f5562370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39fcd7d3124a75ed076cc7f1ef7f3201"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mips__test.html#ga39fcd7d3124a75ed076cc7f1ef7f3201">mips_test_end_test</a> (int testId, int passed, const char *msg)</td></tr>
<tr class="separator:ga39fcd7d3124a75ed076cc7f1ef7f3201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad235f3b32465f635746e94673bb99672"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mips__test.html#gad235f3b32465f635746e94673bb99672">mips_test_end_suite</a> ()</td></tr>
<tr class="separator:gad235f3b32465f635746e94673bb99672"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This collection of functions is used for defining test suites. Just like the CPU and memory APIs, it is defined as a set of functions, leaving freedom to have different implementations and clients. The broad idea is that of Unit Testing <a href="http://en.wikipedia.org/wiki/Unit_testing">http://en.wikipedia.org/wiki/Unit_testing</a> so there are lots of small tests which try to check the functionality of many independent parts, in this case instructions. Usually this would be followed by Integration Testing <a href="http://en.wikipedia.org/wiki/Integration_testing">http://en.wikipedia.org/wiki/Integration_testing</a> to check that the parts work correctly together, but that is mostly out of scope here.</p>
<p>Integration testing is a huge problem in real-world CPU design and implementation, as the interaction between many individual components within a CPU can lead to very subtle bugs, even when the components appear to be fine. You will be able to test some instructions individually, but some instructions are impossible to test in isolation (the API is carefully designed in that regard), and will require a sequence of instructions. I will also give you larger programs to try running later on, so you'll be able to see whether your testing of individual instructions results in a processor that can run real programs with thousands of instructions.</p>
<p>This particular unit testing API is extremely simple, and has few of the standard features one would expect from a standard API, such as JUnit or CppUnit. Typically they support things like nesting of test suites, can indicate dependencies ("don't run this complex test if
    another simpler test already failed"), and support multiple output formats (GUI dashboards are quite common). Another thing that is missing is Continuous Integration, whereby the tests are automatically run as development continues, usually in concert with source control. For this test framework, it is assumed that every time you run the test suite all tests will be run, so you'll be able to see if adding new functionality has broken things that used to work - when new features break old ones it is a regression (things have got worse), so this is a form of Regression Testing <a href="http://en.wikipedia.org/wiki/Regression_testing">http://en.wikipedia.org/wiki/Regression_testing</a>.</p>
<p>The main things the test framework requires you to do are:</p>
<ul>
<li>Indicate when you are starting the test suite with mips_test_begin_suite</li>
<li>For each individual test you run, use mips_test_begin_test to record the what the test is testing, then mips_test_end_test to record if it passed or failed.</li>
<li>Use mips_test_end_suite to say that all tests have ended, so that the test framework can do things like calculate statistics.</li>
</ul>
<p>So an individual test would look something like: </p><pre class="fragment">int testId=mips_test_begin_test("ADD");
...
mips_cpu_set_register(cpu, 1, 5);
mips_cpu_set_register(cpu, 2, 5);
...
</pre><p> Make the simulator do reg[1]=reg[1]+reg[2] ... uint32_t got; mips_error err=mips_cpu_get_register(cpu, 1, &amp;got); mips_test_end_test(testId, (err==mips_Success) &amp;&amp; (got==10), "Testing 5+5 == 10");</p>
<p>While the overall test suite would look like: </p><pre class="fragment">mips_test_begin_suite();

testId=mips_test_begin_test(...);
...
mips_test_end_test(testId, ...);

testId=mips_test_begin_test(...);
...
mips_test_end_test(testId, ...);

mips_test_end_suite();
</pre><p>Exactly how you structure it is up to you, the main requirement is that a given test should actually test the instruction it says it is - if you say you are testing MULU, but that instruction never executes within the scope of the test, then the test doesn't count. You should aim to test all instructions that you implement.</p>
<p>As you add tests, you will notice a lot of repetition, between different tests of one instruction, and the testing of different instructions. As a programmer, whenever you see repetition you should thing about automation. This is a programmatic framework, so how much replicated functionality can be wrapped up inside a function? </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga312db36c134785e2b382a551bd2b420c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mips_test_begin_suite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call once at the beginning of all tests to setup testing information. </p>

</div>
</div>
<a class="anchor" id="ga7b2f60bc6a25235b5aad5a89f5562370"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mips_test_begin_test </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>instruction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Used before starting an individual test </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instruction</td><td>String identifying which instruction the test is targetting, for example "add", "lw", etc.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>unique identifier identifying the test</td></tr>
  </table>
  </dd>
</dl>
<p>You may have some tests which are not associated with any instruction, in which case use the string "&lt;internal&gt;". These can be useful to establish certain invariants, like "if I set register 3 to a value, then if I read register 3 it should still be the same value". </p>

</div>
</div>
<a class="anchor" id="gad235f3b32465f635746e94673bb99672"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mips_test_end_suite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call once at the end of all tests to indicate that all tests have now ended. </p>

</div>
</div>
<a class="anchor" id="ga39fcd7d3124a75ed076cc7f1ef7f3201"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mips_test_end_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>testId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Used to indicate whether an individual test passed or failed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testId</td><td>The unique identifier returned from mips_test_begin_test.</td></tr>
    <tr><td class="paramname">passed</td><td>Flag to indicate if the test succeeded (passed!=0) or failed (passed==0).</td></tr>
    <tr><td class="paramname">msg</td><td>An optional message to explain what you the test was looking for in case it failed. Can be NULL if there is nothing useful to print, or you don't want to write a message. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
